<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>受容的命名．配列→ボタン生成版（3段階トグル）</title>
    <link rel="stylesheet" href="default.css">
    <link rel="stylesheet" href="labeling.css">    
</head>

<body>
    <h1>受容的命名</h1>

    <!-- グループ切り替え -->
    <div class="groups" role="tablist" aria-label="グループ切り替え">
        <button type="button" class="group-button active" data-group="group1" onclick="showGroup('group1')">物3D</button>
        <button type="button" class="group-button" data-group="group2" onclick="showGroup('group2')">数</button>
        <button type="button" class="group-button" data-group="group3" onclick="showGroup('group3')">人</button>
        <button type="button" class="group-button" data-group="group4" onclick="showGroup('group4')">ひらがな</button>
        <button type="button" class="group-button" data-group="group5" onclick="showGroup('group5')">いろ</button>
        <button type="button" class="group-button" data-group="group6" onclick="showGroup('group6')">かたち</button>
        <button type="button" class="group-button" data-group="group7" onclick="showGroup('group7')">動詞</button>
    </div>

    <!-- 一括操作 -->
    <div class="bar">
        <button type="button" onclick="setAllState(0)">全て0にする</button>
        <button type="button" onclick="setAllState(1)">全て1にする</button>
        <button type="button" onclick="setAllState(2)">全て2にする</button>
    </div>

    <div class="muted">ボタンをクリックすると 0→1→2→0 と循環します。課題生成では state≥1 を「選択」とみなします。</div>

    <!-- 3状態ボタングリッド -->
    <div id="buttonGrid" class="grid" aria-live="polite"></div>

    <!-- 既存のコントロール群 -->
    <div class="controls">
        <div class="control">
            <label for="choiceCount">択数</label>
            <select id="choiceCount">
                <option value="2" selected>2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div class="control">
            <label for="repetitionCount">レップ数</label>
            <select id="repetitionCount">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
        </div>
        <div class="control">
            <label for="setCount">セット数</label>
            <select id="setCount">
                <option value="5">5</option>
                <option value="10" selected>10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="60">60</option>
                <option value="70">70</option>
                <option value="80">80</option>
            </select>
        </div>
    </div>

    <div class="bar">
        <button id="generateTaskButton" type="button">チェックした物で課題を生成する</button>
        <button id="copyButton" type="button">クリップボードにコピー</button>
    </div>

    <div id="dist"></div>
    <div id="questions-container"></div>
    <div class="hr"></div>
    <div id="output"></div>

    <!-- 3状態UIの最小限スクリプト（データと描画のみ） -->
    <script>
        const uiGroups = {
            group1: [
                { t: "サイ", s: 0 },
                { t: "パンダ", s: 0 },
                { t: "キリン", s: 1 },
                { t: "ペンギン", s: 0 },
                { t: "しまうま", s: 0 },
                { t: "がおー", s: 1 },
                { t: "ぱおーん", s: 1 },
                { t: "もーもー", s: 1 },                
                { t: "うっほっほ", s: 1 },                
                { t: "はとぽっぽ", s: 0 },
                { t: "めぇー", s: 0 },                
                { t: "とら", s: 0 },                
                { t: "ぶーぶー", s: 0 },                                
                { t: "さい", s: 0 },                                                
                { t: "パンダ", s: 0 },                                                                
                { t: "かめ", s: 0 },                                                                                
                { t: "くま", s: 0 },                                                                                                
                //    
                { t: "電車", s: 1 },
                { t: "ひこうき", s: 1 },
                { t: "くるま", s: 0 },
                { t: "救急車", s: 1 },
                { t: "パトカー", s: 0 },
                { t: "消防車", s: 1 },
                //
                { t: "かぶとむし", s: 0 },
                { t: "くわがた", s: 0 },
                { t: "ちょうちょ", s: 0 },
                //
                { t: "バナナ", s: 1 },
                { t: "りんご", s: 0 },
                { t: "みかん", s: 0 },
                { t: "いちご", s: 0 },
                { t: "ヨーグルト", s: 0 },
                { t: "パン", s: 0 },
                { t: "きゅうり", s: 0 },                
                { t: "かぼちゃ", s: 0 },                                
                { t: "ぶどう", s: 0 },                                                
                { t: "とまと", s: 0 },                                                                
                //
                { t: "コップ", s: 1 },
                { t: "歯ブラシ", s: 1 },
                { t: "リモコン", s: 1 },
                { t: "フォーク", s: 1 },
                { t: "スプーン", s: 0 },
                { t: "バケツ", s: 0 },
                { t: "まきじゃく", s: 0 },
                { t: "ボール", s: 0 },
                { t: "おむつ", s: 0 },
                { t: "くつ", s: 0 },
                { t: "とけい", s: 0 },                
                { t: "しんごう", s: 0 },                                
                //
                { t: "ショーン", s: 0 },
                { t: "ビッツァー", s: 0 },
                { t: "トーマス", s: 0 },
                { t: "ジョージ", s: 0 },
                { t: "ピングー", s: 0 },
                //
                { t: "ちょきちょき", s: 1 },
                { t: "ぷっぷー", s: 0 },

            ],
            group2: [
                { t: 'いち', s: 1 }, { t: 'に', s: 1 }, { t: 'さん', s: 1 }, { t: 'よん', s: 1 }
            ],
            group3: [
                { t: 'まま', s: 1 }, { t: 'ねね', s: 1 }, { t: 'ぱぱ', s: 1 }, { t: 'ジョージ', s: 0 },
                { t: 'ピングー', s: 0 }, { t: 'ショーン', s: 0 }, { t: 'ビッツァー', s: 0 }
            ],
            group4: [
                { t: 'あ', s: 1 }, { t: 'い', s: 1 }, { t: 'う', s: 1 }, { t: 'え', s: 1 }
            ],
            group5: [
                { t: 'あか', s: 1 }, { t: 'きいろ', s: 1 }, { t: 'あお', s: 1 }, { t: 'みどり', s: 1 }, { t: 'ピンク', s: 1 }
            ],
            group6: [
                { t: 'まる', s: 1 }, { t: 'さんかく', s: 1 }, { t: 'しかく', s: 1 }
            ],
            group7: [
                { t: 'だっこ', s: 1 }, { t: 'ごしごし', s: 1 }, { t: 'てれび', s: 1 }, { t: 'お風呂', s: 1 },
                { t: 'いただきます', s: 1 }, { t: 'ねんね', s: 1 }, { t: 'ぼーる', s: 1 }, { t: 'ふきふき', s: 1 },
                { t: 'えほん', s: 1 }, { t: 'ちょきちょき', s: 1 }, { t: 'ばんざい', s: 1 }, { t: 'ごくごく', s: 1 }, { t: 'しゃかしゃか', s: 1 }
            ]
        };

        let currentGroup = 'group1';

        //    function ensureState(o){ if (typeof o.s !== 'number') o.s = o.c ? 1 : 0; return o.s; }
        function updateButtonClass(btn, s) { btn.classList.remove('state0', 'state1', 'state2'); btn.classList.add(`state${s}`); }

        function renderButtonsForGroup(groupKey) {
            const container = document.getElementById('buttonGrid');
            container.textContent = '';
            const list = uiGroups[groupKey];
            if (!list) return;
            list.forEach((obj, idx) => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'item';
                const s = (obj.s ?? 0);                  // ← 直接参照
                updateButtonClass(btn, s);
                btn.textContent = obj.t;
                btn.dataset.index = String(idx);
                btn.setAttribute('aria-pressed', String(s));
                btn.addEventListener('click', () => {
                    obj.s = (obj.s + 1) % 3;               // ← 0→1→2→0
                    updateButtonClass(btn, obj.s);
                    btn.setAttribute('aria-pressed', String(obj.s));
                });
                container.appendChild(btn);
            });
        }

        function setAllState(state) {
            uiGroups[currentGroup].forEach(o => o.s = state);
            renderButtonsForGroup(currentGroup);
        }

        // 互換＋UI更新をまとめた showGroup
        function showGroup(key) {
            currentGroup = key;
            console.log('showGroup', key);
            // グループボタンのactive切替
            document.querySelectorAll('.group-button').forEach(b => b.classList.toggle('active', b.dataset.group === key));
            // 旧チェックボックス群（ダミー）の表示切替（taskGenerator02.js 互換）
            document.querySelectorAll('.checkbox-group').forEach(g => g.style.display = (g.id === key ? 'block' : 'none'));
            // 3状態ボタンを再描画
            renderButtonsForGroup(key);
        }

    </script>

    <!-- 外部ロジック読込：統計/課題生成など -->
    <script src="taskGenerator02.js"></script>
</body>

</html>